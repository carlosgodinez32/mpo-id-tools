(function (thisObj){  main();function main () {   var sel = app.activeDocument.selection;   if(sel.length < 1) {       alert("no selection");       return;       }  var numofcols = 1;   var page = sel[0].parentPage;   var margPrefs = page.marginPreferences;   var columns = margPrefs.columnsPositions;//~     alert( columns[1] + margPrefs.left  - columns[0]);    var simpleDialog = app.dialogs.add({      name: "Fit to Margins",      canCancel: true    });    var list = [];    for(var i = 1; i <= margPrefs.columnCount;i++){      list.push(String(i) + " column");    }    var sdiag_column1 = simpleDialog.dialogColumns.add();    var modeDropdown = sdiag_column1.dropdowns.add({      stringList: list,      selectedIndex: 0,      minWidth: 75    });   if (simpleDialog.show() === true) {    numofcols =  modeDropdown.selectedIndex + 1;      simpleDialog.destroy();  }   var mwidth = columns[1] - columns[0] ;//  62.333 ;   var w = (mwidth * numofcols) + (margPrefs.columnGutter * (numofcols - 1));   fit_to_margins (sel,w);}   function fit_to_margins(sel, newwidth){    for(var i =0;i < sel.length;i++){            var curbnds = sel[i].geometricBounds;            sel[i].geometricBounds = [curbnds[0],curbnds[1],curbnds[2], curbnds[1] + newwidth];        }    }    })(this);